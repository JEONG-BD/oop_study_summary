# 역할, 책임, 협력 
## 목차

[1. 협력](#1협력)  
* [1-1. 요청하고 협력하는 사람들 ](#11-요청하고-협력하는-사람들)  

[2. 책임](#2-책임)  
* [2-1. 책임의 분류](#21-책임의-분류)  
* [2-2. 책임과 메시지](#22-책임과-메시지)  

[3. 역할](#3-역할)   
* [3-1. 책임의 집합이 의미하는 것](#31-책임의-집합이-의미하는-것)   
* [3-2. 판사와 증인](#32-판사와-증인) 
* [3-3. 역할이 답이다](#33-역할이-답이다)   
* [3-4. 협력의 추상화](#34-협력의-추상화)
* [3-5. 대체 가능성](#34-협력의-추상화)

[4. 객체의 모양을 결정하는 협력](#4-객체의-모양을-결정하는-협력)
* [4-1. 흔한 오류](#41-흔한-오류)
* [4-2. 협력을 따라 흐르는 객체의 책임](#42-협력을-따라-흐르는-객체의-책임)

[5. 객체 지향 설계 기법 ](#5-객체지향-설계-기법)   
* [5-1. 책임 주도 설계](#51-책임-주도-설계)
* [5-2. 디자인 패턴](#52--디자인-패턴)
* [5-3. 테스트 주도 개발](#53-테스트-주도-개발)

객체지향 설계의 전체적인 품질을 결정하는 것은 개별 객체의 품질이 아니라 여러 객체들이 모여 이루어내는 협력의 품질이다.<br> 
협력이 자리 잡으면 저절로 객체의 행동이 드러나고 뒤이어 적절한 객체의 상태가 결정된다. **객체의 모양을 빚는 것은 객체가 참여하는 협력이다**. 어떤 협력에 참여하는지가 객체에 필요한 행동을 결정하고, 필요한 행동이 객체의 상태를 결정한다.

## 1.협력
### 1.1 요청하고 협력하는 사람들
- 협력이란 한 사람이 다른 사람에게 도움을 요청할 때 시작되고 요청을 받은 사람은 일을 처리한 후 요청한 사람에게 필요한 지식이나 서비스를 제공한는 것으로 요청에 응답한다. 
- 협력이란 다수의 요청과 응답으로 구성되며 전체적으로 다수의 연쇄적인 요청과 응답으로 구성된다. 
- 객체지향 세계에서 동일한 목적을 달성하기 위해서 협력한다.

*** 

## 2. 책임 
- 객체지향의 세계에서 어떤 객체가 어떤 요청에 대답 또는 적절한 행동을 할 의무가 있는 것은 해당 객체가 책임을 가진다고 한다.
    > 왕 → 재판을 수행할 책임  
    > 하얀 토끼→ 증인을 불러올 책임   
    > 모자장수 → 증인석에 입장 할 책임, 증언할 책임 

### 2.1 책임의 분류
- 협력에 참여하는 객체들은 목표를 달성하는데 필요한 책임을 수행 한다.
- 책임은 객체에 의해 정의되는 응집도 있는 행위의 집합으로 객체가 알아야 할 정보 와 객체가 수행할 수 있는 행위에 대해 개략적으로 서술한 문장으로 볼 수 있다. 
- 객체의 책임은 **하는 것**과 **아는 것** 두가지로 구성 된다. 
- doing(객체가 무엇을 할 수 있는가? )
    
    > 객체를 생성하거나 계산하는 등의 스스로 하는 것  
    > 다른 객체의 행동을 시작시키는 것  
    > 다른 객체의 활동을 제어하고 조절하는 것  
- knowing(객체가 무엇을 알고 았는가?)
    > 개인적인 정보에 관해 아는 것  
    > 관련된 객체에 관해 아는 것  
    > 자신이 유도하거나 계싼할 수 있는 것에 아는 것  
    
- 책임은 객체의 외부에 제공해 줄 수 있는 정보와 외부에 제공해 줄 수 있는 서비스의 목록이다. **책임은 객체의 인터페이스를 구성한다**.

### 2.2 책임과 메시지 
- 협력 안에서 객체는 다른 객체로 부터 요청이 전송됐을 경우에만 자신에게 주어진 책임을 수행한다.
- 객체가 다른 객체에게 주어진 **책임을 수행하도록 요청을 보내는 것을 메시지 전송이라고 한다**. 두 객체의 협력은 메시지를 통해서 이뤄진다.
- 책임이 협력이라는 문맥 속에서 요청을 수신 하는 한 쪽이 객체 관점에서 무엇을 할 수 있는지를 나열하는 것이라면 메시지는 협력에 참여하는 두 객체 사이의 관계를 강조하는 것이다.
- 주의할 점은 책임과 메시지의 수준이 같지는 않다는 점이다. 책임은 객체가 협력에 참여하기 위해 수행해야 하는 행위를 상위 수준에서 개략적으로 서술한 것이다.
- 책임을 결정한 후 실제로 협력을 정제하면서 이를 메시지로 변환할 때는 하나의 책임이 여러 메시지로 분할되는 것이 일반적이다.

*** 
## 3. 역할 
### 3.1 책임의 집합이 의미하는 것 
- 협력의 관점에서 어떤 객체가 어떤 책임의 집합을 수행한다는 것은 어떤 의미인가?
    >  모자 장수가 증인석에 입장하고, 모자 장수가 증언한다 는 책임  
    >  왕이 재판하고 하얀토끼에게 목격자를 소환 요청 증언 요구 한다는 책임  
    >  모자 장수는 증인이라는 역할 왕은 판사라는 역할  

- 어떤 객체가 수행하는 책임의 집합은 객체가 협력 안에서 수행해야 할 역할을 암시한다. 
    > 왕  → 토끼 → 요리사(증인)  
    > 왕 → 토끼 → 모자장수(증인)   
    > 여왕 → 토끼 → 앨리스(증인)    

### 3.2 역할이 답이다
- 다른 세 개의 재판 과정, 세 개의 협력이 주어져있고 과정이 비슷해서 하나의 협력으로 다루고 싶다. 
- 판사와 증인이라는 역할(role)을 사용하면 세가지 협력을 모두 포괄 할 수 있는 하나의 협력으로 추상화 가능하다.
- 역할을 이용해서 협력을 추상화했다. 판사나 증인의 역할을 수행할 수 있는 어떤 객체라도 협력에 참여할 수 있다.
- 하지만 역할을 대체하기 위해서 각 역할이 수신할 수 잇는 메시지를 동일한 방식으로 이해해야 한다.    
- 어떤 객체라도 ‘판사’, ‘증인’의 역할을 대체할 수 있는가?
    > - 판사(하트왕,하트 여왕)
    >     - 재판하라 
    > - 증인(모자장수, 요리사, 앨리스)
    >     - 증인석에 입장하라
    >     - 증언하라
- 역할의 개념을 사용하면 유사학 혁력을 추상화해서 인지 과부하를 줄일 수 있고, 다양한 객체들이 협력에 참여할 수 있다.
- **역할은 객체 지향설계 단순성, 유연선, 재사용성을 뒷받침하는 핵심 개념이다**.

### 3.4 협력의 추상화 
- 역할의 가장 큰 가치는 하나의 협력 안에 여러 종유의 객체가 참여할 수 있게 함으로써 협력을 추상화한다.
- 협력의 추상화는 설계자가 다뤄야 하는 협력의 개수를 줄이고 구체적인 객체를 추상적인 역할로 대체함으로써 협력을 양상을 단순화한다.
   <br>
   
    > 왕(판사) - 하얀토끼(토끼) - 모자 장수(증인)   
    > 왕(판사) - 하얀토끼(토끼) - 앨리스(증인)
    <br>


- 구체적인 객체로 추상적인 역할을 대체해서 동일한 구조의 협력을 다양한 문맥에서 재사용할 수 있는 능력은 객체 지향의 힘이다.

### 3.5 대체 가능성 
- 객체의 역할 대체는 행동의 호환을 주목해야 한다. 
- 역할은 협력 안에서 구체적인 객체로 대체될 수 있는 추상적인 협력자다.
- 본질적으로 역할은 다른 객체에 의해 가능함을 의미하고 행동이 호환돼야 한다.
- 객체가 역할을 대체 가능하기 위해서 협력 안에서 역할이 수행하는 모든 책임을 동일하게 수행 할 수 있어야 한다.
- 객체의 역할에는 주어진 책임 이외에 다른 책임을 수행할 수 있음을 주목하도록 하자. 
- 객체는 역할이 암시하는 책임보다 더 많은 책임을 가질수 있고 이것이 바로 객체의 타입과 역할 사이에 일반화/특수화 관계가 성립하는 것이다.
***
## 4. 객체의 모양을 결정하는 협력 

### 4.1 흔한 오류
- 시스템에 필요한 데이터를 저장하기 위해서 객체가 존재한다는 선입견
- 객체가 상태의 일부로 데이터를 포함하지만 데이터는 객체가 행위를 수행하는데 필요한 재료일 뿐이다.
- 객채지향이 클래스간의 관계를 표현하는 시스템의 정적인 측면에 중점을 두는 선입견
- 클래스는 단지 시스템에 필요한 객체를 표현하고 생성하기 위해 프로그래밍 언어가 제공하는 구현 메커니즘이다.

### 4.2 협력을 따라 흐르는 객체의 책임
- 올바른 객체를 설계 하기 위해서는 견고하고 깔끔한 협력을 설계해야 한다.
- 협력을 설계한다는 것은 협력에 참여하는 객체들이 주고 받을 요청과 응답의 흐름을 결정한다는 것을 의미한다. 
- 결정된 요청과 응답의 흐름은 객체가 협력에 참여하기 위해 수행할 책임이 된다. 
- **객체에게 책임을 할당하면 책임은 객체가 외부에 제공하게 될 행동이 된다**.  
- 협력이라는 문맥에서 객체가 수행하게 될 적절한 책임, 즉 행동을 결정한 후에 그 행동을 수행하는 데 필요한 데이터를 고민해야 한다. 그리고 객체가 협력에 참여하기 위해 필요한 데이터와 행동이 어느 정도 결정된 후에 클래스의 구현 방법을 결정해야 한다.
- 객체의 행위에 초점을 맞추기 위해서는 협력이라는 실행 문맥 안에서 책임을 분배해야 한다. 객체가 참여할 문맥인 협력 부터 정의하자.
***

## 5. 객체지향 설계 기법 
### 5.1 책임 주도 설계
- 객체지향 설계란 애플리케이션의 기능을 구현하기 위한 협력관계를 고안하고 협력에 필요한 역할과 책임을 식별한 후 이를 수행할 수 있는 적절한 객체를 식별해 나가는 과정이다.
- 객체 지향 설계의 핵심은 올바른 책임을 올바른 객체에게 할당 것이다. 
- 시스템의 기능은 더 작은 규모의 책임으로 분할 후 각 책임은 책임을 수행할 적절한 객체에게 할당 한다.
- 객체가 책임을 수행하는 도중에 스스로 처리할 수 없는 정보나 기능이 필요한 경우 적절한 객체를 찾아 필요한 작업을 요청한다. 
- 요청된 작업을 수행하는 일은 이제 작업을 위임받은 객체의 책임으로 변환된다. 객체가 다른 객체에게 작업을 요청하는 행위를 통해 결과적으로 객체들 간의 협력 관계가 만들어진다. 
- 책임을 여러 종류의 객체가 수행할 수 있다면 협력자는 객체가 아니라 추상적인 역할로 대체된다.

### 5.2  디자인 패턴
- 책임 주도 설계는 객체의 역할 책임 협력을 고안하기 위한 방법과 절차를 제시하지만 디자인 패턴은 책임 주도 설계의 결과를 표현한다.
- 패턴은 특정한 상황에서 설계를 돕기 위해 모방하고 수정할 수 있는 과거의 설계 경험이다.
- 디자인 패터은 반복적으로 발생하는 문제와 그 문제에 대한 해법의 쌍으로 정의된다.
    
### 5.3 테스트 주도 개발
- 테스트 주도 개발은 애잘일 방법론의 한 종류 설계 기법이다. 
- 테스트 주도 개발은 객체가 이미 존재한다고 가정하고 객체에게 어떤 메시지를 전송할 것인가를 먼저 생각해야 한다. .
- 테스트 주도 개발은 책임 주도 설계를 통해 도달해야 하는 목적지를 테스트라는 안전장치를 통해 좀더 빠르고 견고한 방법으로 도달 할 수 있게 해주는 최상의 프랙티스다.
- 테스트 주도 개발은 객체지향에 대한 깊이 있는 지식을 요구한다.
   
    > 객체의 메서드를 호출하고 반환값을 검증하는것 → 객체 수행할 책임
    > 테스트에 필요한 간접 입력 스텁이나 목 객체 → 협력해야 하는 협력체
***
> 조영호, 『객체지향의 사실과 오해』, 위키북스(2015)  

